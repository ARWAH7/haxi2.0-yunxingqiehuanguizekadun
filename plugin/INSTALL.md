# 哈希游戏自动下注插件 - 安装与使用指南

## 一、系统要求

- **浏览器**: Google Chrome 88+ 或 Microsoft Edge 88+ (支持 Manifest V3)
- **后端服务**: HAXI 后端需运行在可访问地址 (默认 `http://localhost:3001`)
- **游戏页面**: 支持尾数单双和尾数大小玩法

---

## 二、安装步骤

### 步骤1: 获取插件文件

确保项目中的 `plugin/` 目录包含以下文件:
```
plugin/
├── manifest.json        # 插件配置文件
├── content.js           # 核心逻辑(注入游戏页面)
├── panel.css            # 悬浮面板样式
├── background.js        # 后台服务
├── popup/
│   ├── popup.html       # 弹窗页面
│   └── popup.js         # 弹窗逻辑
└── icons/
    ├── icon16.png       # 16px图标
    ├── icon48.png       # 48px图标
    └── icon128.png      # 128px图标
```

### 步骤2: 在Chrome中加载插件

1. 打开Chrome浏览器，在地址栏输入: `chrome://extensions/`
2. 打开右上角的 **"开发者模式"** 开关
3. 点击左上角 **"加载已解压的扩展程序"**
4. 选择项目中的 `plugin/` 文件夹
5. 插件安装成功后，浏览器右上角会出现插件图标

### 步骤3: 配置后端API地址

1. 点击浏览器右上角的插件图标，打开弹窗
2. 在 **"后端API设置"** 中填入后端地址:
   - 本地开发: `http://localhost:3001`
   - 远程服务: 填写实际后端URL
3. 点击 **"保存设置"**
4. 弹窗会显示后端连接状态: "已连接" 表示成功

### 步骤4: 打开游戏页面

1. 在浏览器中打开哈希游戏页面:
   - 尾数单双: `https://v8jump-01-xxx.ap-east-1.elb.amazonaws.com:8888/hashGame?tab=尾数单双`
   - 尾数大小: `https://v8jump-01-xxx.ap-east-1.elb.amazonaws.com:8888/hashGame?tab=尾数大小`
2. **重要**: 首次安装或更新插件后，需要**刷新游戏页面**(F5)才能加载插件
3. 页面右上角会出现紫色渐变头部的 **"HAXI 自动下注"** 悬浮面板

---

## 三、功能说明

### 3.1 悬浮控制面板

面板包含以下区域:

#### 区块匹配状态
- **页面区块**: 从游戏页面读取的"当前下注区块"号码
- **后端区块**: 后端最新已处理的区块号码
- **匹配状态**:
  - "已匹配" (绿色) - 页面区块 = 后端区块 + 步长，可以下注
  - "不匹配" (红色) - 区块不同步，等待同步
  - "等待中" (黄色) - 正在获取数据

#### 统计面板
- 胜/负次数、胜率、盈亏金额、总下注金额

#### 配置区
详见下方资金策略和自动目标说明。

### 3.2 资金策略 (8种)

| 策略 | 说明 | 关键参数 |
|------|------|----------|
| **平注策略** | 每次下注固定金额 | 基础注额 |
| **马丁格尔** | 输了加倍，赢了回到基础注额 | 倍率, 最大轮数 |
| **达朗贝尔** | 输了加步长，赢了减步长 | 步长 |
| **斐波那契** | 按斐波那契数列调整注额 | 基础注额 |
| **帕罗利** | 赢了加倍(最多3连)，输了回基础 | 基础注额 |
| **1-3-2-6** | 按1→3→2→6序列递进 | 基础注额 |
| **自定义倍投** | 用户自定义倍投序列 | 自定义序列(逗号分隔) |
| **AI动态凯利** | 基于凯利公式动态计算最优注额 | 凯利系数(0.05~1.0) |

### 3.3 自动目标 (12种)

| 目标模式 | 说明 |
|----------|------|
| **定买单/双/大/小** | 每次固定买同一方向 |
| **跟上期(顺)** | 跟随上一期结果方向 |
| **反上期(反)** | 与上一期结果相反 |
| **随机单双/大小** | 随机选择方向 |
| **参考近期走势(顺/反)** | 参考N期前的结果(滞后复制/反转) |
| **长龙顺势跟投** | 连续出现相同结果时跟着买 |
| **长龙反势跟投** | 连续出现相同结果时反着买 |
| **AI单规托管** | 使用AI分析单条规则给出预测 |
| **AI全域全规则** | AI扫描所有规则选最优预测 |

### 3.4 通用参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 基础注额 | 每次下注的基础金额 | 10 |
| 赔率 | 游戏赔率 | 1.96 |
| 止盈金额 | 盈利达到此值自动停止(0=不限) | 0 |
| 止损金额 | 亏损达到此值自动停止(0=不限) | 0 |
| 规则步长 | 区块采样步长(与前端配置一致) | 1 |
| 起始区块 | 采样起始区块高度(0=自动) | 0 |

---

## 四、使用流程

### 4.1 基本操作

1. **打开游戏页面** → 悬浮面板自动出现
2. **查看区块匹配状态** → 确认"已匹配"
3. **选择资金策略** → 如"马丁格尔"
4. **选择自动目标** → 如"定买单"
5. **设置基础注额** → 如10
6. **点击"保存配置"** → 配置保存到后端(下次自动加载)
7. **点击"开始自动下注"** → 引擎启动

### 4.2 下注执行流程

插件自动执行以下步骤(每3秒一个周期):
1. 读取页面"当前下注区块"号码
2. 获取后端最新区块数据
3. **匹配校验**: 确认页面区块 = 后端区块 + 步长
4. 根据自动目标策略确定下注方向(单/双/大/小)
5. 根据资金策略计算本轮下注金额
6. **点击重置** → 清空页面旧金额
7. **输入金额** → 在"输入金额"框中填入计算的金额
8. **点击确定** → 确认金额
9. **点击下注** → 点击对应的单/双/大/小按钮
10. 等待开奖结果，更新统计

### 4.3 停止下注

- 点击 **"停止下注"** 按钮手动停止
- 达到止盈金额自动停止
- 达到止损金额自动停止

---

## 五、面板操作

| 操作 | 说明 |
|------|------|
| 拖动标题栏 | 移动面板位置 |
| 点击 **−** | 最小化/展开面板 |
| 点击 **×** | 关闭面板(停止引擎) |
| **保存配置** | 将当前配置保存到后端Redis |
| **重置统计** | 清空胜负记录和盈亏数据 |

---

## 六、注意事项

1. **首次安装后必须刷新游戏页面** - Chrome插件不会自动注入到已打开的页面
2. **确保后端服务已启动** - 插件依赖后端API获取区块数据和AI信号
3. **规则步长必须与前端配置一致** - 否则区块匹配会失败
4. **区块不匹配时不会下注** - 这是安全机制，确保下注在正确的区块上
5. **每个区块只下注一次** - 防止重复下注
6. **支持尾数单双和尾数大小** - 插件自动检测当前游戏类型
7. **配置自动保存/加载** - 通过"保存配置"按钮保存后，下次打开自动加载

---

## 七、故障排查

| 问题 | 解决方案 |
|------|----------|
| 面板不出现 | 刷新页面(F5)；检查插件是否已启用；确认在游戏页面 |
| 后端未连接 | 检查后端是否运行；在弹窗中确认API地址正确 |
| 区块不匹配 | 确认规则步长与前端配置一致；等待后端同步最新区块 |
| 下注按钮点击无效 | 游戏页面结构可能更新，需要更新DOM选择器 |
| 金额设置失败 | 确认游戏页面有"输入金额"输入框和"确定"按钮 |

---

## 八、更新插件

1. 修改插件文件后，打开 `chrome://extensions/`
2. 找到"哈希游戏自动下注插件"
3. 点击 **刷新** 按钮(圆形箭头图标)
4. 刷新游戏页面(F5)
